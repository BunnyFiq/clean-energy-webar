<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AR Demo - Clean Energy</title>

    <style>
      * { margin: 0; padding: 0; box-sizing: border-box; }
      
      body { 
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 20px;
      }

      #container {
        width: 100%;
        max-width: 900px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        padding: 30px;
        animation: slideIn 0.8s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      }

      @keyframes slideIn {
        from { transform: translateY(50px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }

      h1 {
        text-align: center;
        color: #1a1a2e;
        margin-bottom: 10px;
        font-size: 28px;
      }

      .subtitle {
        text-align: center;
        color: #666;
        margin-bottom: 30px;
        font-size: 14px;
      }

      #videoGrid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 30px;
      }

      @media (max-width: 768px) {
        #videoGrid { grid-template-columns: 1fr; }
      }

      .video-wrapper {
        position: relative;
        background: #000;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
      }

      .video-label {
        position: absolute;
        top: 10px;
        left: 10px;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 700;
        z-index: 10;
      }

      video {
        width: 100%;
        display: block;
        border-radius: 12px;
      }

      /* Unmute prompt (only shows if autoplay with sound fails) */
      #unmutePrompt {
        display: none;
        text-align: center;
        padding: 20px;
        background: #fff3cd;
        border: 2px solid #ffc107;
        border-radius: 12px;
        margin-bottom: 20px;
      }

      #unmutePrompt.visible {
        display: block;
        animation: bounce 0.6s;
      }

      @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-10px); }
      }

      #unmutePrompt button {
        margin-top: 10px;
        padding: 12px 24px;
        background: #ffc107;
        border: 0;
        border-radius: 8px;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.3s;
      }

      #unmutePrompt button:hover {
        background: #ffb300;
        transform: scale(1.05);
      }

      /* Action buttons */
      #actionButtons {
        display: none;
        justify-content: center;
        gap: 20px;
        margin-top: 20px;
      }

      #actionButtons.visible {
        display: flex;
        animation: slideUp 0.6s cubic-bezier(0.68, -0.55, 0.27, 1.55);
      }

      @keyframes slideUp {
        from { transform: translateY(30px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }

      #actionButtons button {
        padding: 16px 32px;
        font-size: 16px;
        font-weight: 700;
        border: 0;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s;
      }

      #replayBtn {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      #replayBtn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(102, 126, 234, 0.6);
      }

      #backBtn {
        background: white;
        color: #0f172a;
        border: 2px solid #e0e0e0;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      }

      #backBtn:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }

      .status-bar {
        text-align: center;
        padding: 12px;
        background: rgba(56, 189, 248, 0.1);
        border-radius: 8px;
        color: #0c4a6e;
        font-weight: 600;
        margin-bottom: 20px;
      }
    </style>
  </head>

  <body>
    <div id="container">
      <h1>‚ö° Energy Flow Demo</h1>
      <p class="subtitle">Watch how renewable energy powers your device</p>

      <div class="status-bar" id="statusBar">‚ñ∂Ô∏è Videos playing...</div>

      <!-- Unmute fallback (only shows if needed) -->
      <div id="unmutePrompt">
        <p><strong>üîá Sound is muted</strong></p>
        <p style="margin: 8px 0; font-size: 14px;">Tap below to enable audio</p>
        <button onclick="enableSound()">üîä Enable Sound</button>
      </div>

      <div id="videoGrid">
        <div class="video-wrapper">
          <div class="video-label" id="deviceLabel">Device</div>
          <video id="videoDevice" playsinline></video>
        </div>

        <div class="video-wrapper">
          <div class="video-label" id="renewLabel">Renewable</div>
          <video id="videoRenew" playsinline></video>
        </div>
      </div>

      <div id="actionButtons">
        <button id="replayBtn" onclick="replay()">üîÑ Replay</button>
        <button id="backBtn" onclick="goBack()">üîô Try Other Device</button>
      </div>
    </div>

    <script>
      const params = new URLSearchParams(location.search);
      const device = params.get('device') || 'tv';
      const renew = params.get('renew') || 'solar';

      const deviceVideo = document.querySelector('#videoDevice');
      const renewVideo = document.querySelector('#videoRenew');
      const actionButtons = document.querySelector('#actionButtons');
      const statusBar = document.querySelector('#statusBar');
      const unmutePrompt = document.querySelector('#unmutePrompt');

      const VIDEO_MAP = {
        tv: '3D_MODEL/tv.mp4',
        fan: '3D_MODEL/fan.mp4',
        bulb: '3D_MODEL/bulb.mp4',
        solar: '3D_MODEL/solar.mp4',
        turbine: '3D_MODEL/turbine.mp4'
      };

      const LABELS = {
        tv: 'üì∫ Smart TV',
        fan: 'üåÄ Fan',
        bulb: 'üí° LED Bulb',
        solar: '‚òÄÔ∏è Solar Panel',
        turbine: 'üí® Wind Turbine'
      };

      // Set video sources
      deviceVideo.src = VIDEO_MAP[device] || VIDEO_MAP.tv;
      renewVideo.src = VIDEO_MAP[renew] || VIDEO_MAP.solar;

      // Set labels
      document.querySelector('#deviceLabel').textContent = LABELS[device] || 'Device';
      document.querySelector('#renewLabel').textContent = LABELS[renew] || 'Renewable';

      let videosEnded = { device: false, renew: false };
      let soundEnabled = false;

      // Try to play with sound automatically
      function startVideos() {
        deviceVideo.muted = false;
        renewVideo.muted = false;

        const playDevice = deviceVideo.play();
        const playRenew = renewVideo.play();

        Promise.all([playDevice, playRenew])
          .then(() => {
            console.log('Videos playing with sound');
            soundEnabled = true;
          })
          .catch(err => {
            console.log('Autoplay blocked, showing unmute prompt');
            // Fallback: mute and show unmute button
            deviceVideo.muted = true;
            renewVideo.muted = true;
            deviceVideo.play();
            renewVideo.play();
            unmutePrompt.classList.add('visible');
          });
      }

      // Manual sound enable
      function enableSound() {
        deviceVideo.muted = false;
        renewVideo.muted = false;
        unmutePrompt.classList.remove('visible');
        soundEnabled = true;
      }

      // Detect video end
      deviceVideo.addEventListener('ended', () => {
        videosEnded.device = true;
        checkBothEnded();
      });

      renewVideo.addEventListener('ended', () => {
        videosEnded.renew = true;
        checkBothEnded();
      });

      function checkBothEnded() {
        if (videosEnded.device && videosEnded.renew) {
          actionButtons.classList.add('visible');
          statusBar.textContent = '‚úÖ Demo Complete!';
          statusBar.style.background = 'rgba(34, 197, 94, 0.2)';
        }
      }

      // Replay
      function replay() {
        videosEnded = { device: false, renew: false };
        actionButtons.classList.remove('visible');
        deviceVideo.currentTime = 0;
        renewVideo.currentTime = 0;
        deviceVideo.play();
        renewVideo.play();
        statusBar.textContent = '‚ñ∂Ô∏è Replaying...';
        statusBar.style.background = 'rgba(56, 189, 248, 0.1)';
      }

      // Go back
      function goBack() {
        location.href = 'index.html';
      }

      // Start on page load
      window.addEventListener('load', () => {
        setTimeout(startVideos, 500);
      });
    </script>
  </body>
</html>
