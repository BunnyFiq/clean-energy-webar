<!doctype html>
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>AR Clean Energy Explorer</title>

<script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
<script src="https://cdn.jsdelivr.net/gh/AR-js-org/AR.js/aframe/build/aframe-ar.js"></script>

<style>
/* ---- YOUR ORIGINAL STYLE (UNCHANGED) ---- */
body { margin: 0; overflow: hidden; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
#ui { position: fixed; left: 0; right: 0; bottom: 0; background: rgba(15, 23, 42, 0.78); color: white; padding: 12px 12px 80px 12px; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
.pill { padding: 6px 10px; border-radius: 999px; background: rgba(255,255,255,0.12); font-size: 12px; }
#row { display:flex; gap:10px; flex-wrap:wrap; width:100%; align-items:center; }
button { padding: 10px 12px; border: 0; border-radius: 12px; background: #ffffff; color: #0f172a; font-weight: 800; cursor: pointer; transition: all 0.3s ease; }
button:hover { transform: scale(1.05); }
button.secondary { background: #38bdf8; color: #06283d; }
#demoBtn { display: none; position: fixed; bottom: 15px; left: 50%; transform: translateX(-50%) scale(0); padding: 12px 28px; font-size: 15px; font-weight: 800; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: 2px solid rgba(255,255,255,0.3); border-radius: 30px; box-shadow: 0 6px 25px rgba(102, 126, 234, 0.5); z-index: 100; }
#demoBtn.visible { display: block; animation: demoAppear 0.5s forwards, demoPulse 2s infinite; }
@keyframes demoAppear { to { transform: translateX(-50%) scale(1); opacity: 1; } }
@keyframes demoPulse { 50% { box-shadow: 0 8px 35px rgba(102, 126, 234, 0.7); } }
input[type="range"] { width: 220px; }
#info { width: 100%; margin-top: 6px; font-size: 14px; opacity: 0.95; }
</style>
</head>

<body>

<a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">

<a-assets>
<a-asset-item id="m-fan" src="3D_MODEL/simple_fan.glb"></a-asset-item>
<a-asset-item id="m-bulb" src="3D_MODEL/led_light_bulb.glb"></a-asset-item>
<a-asset-item id="m-solar" src="3D_MODEL/Flat_Solar_Panel.glb"></a-asset-item>
<a-asset-item id="m-wind" src="3D_MODEL/Wind_Turbine.glb"></a-asset-item>
</a-assets>

<!-- TV MARKER -->
<a-marker type="pattern" url="MARKER/tv-marker.patt" emitevents="true" id="marker-tv">
<a-entity id="device" visible="false"></a-entity>
<a-entity id="renewablePivot" visible="false">
<a-entity id="renewable"></a-entity>
</a-entity>
</a-marker>

<!-- FAN MARKER -->
<a-marker type="pattern" url="MARKER/fan-marker.patt" emitevents="true" id="marker-fan">
<a-entity id="device" visible="false"></a-entity>
<a-entity id="renewablePivot" visible="false">
<a-entity id="renewable"></a-entity>
</a-entity>
</a-marker>

<!-- BULB MARKER -->
<a-marker type="pattern" url="MARKER/bulb-marker.patt" emitevents="true" id="marker-bulb">
<a-entity id="device" visible="false"></a-entity>
<a-entity id="renewablePivot" visible="false">
<a-entity id="renewable"></a-entity>
</a-entity>
</a-marker>

<a-entity camera></a-entity>
</a-scene>

<div id="ui">
<div class="pill" id="status">Status: Waiting for markerâ€¦</div>
<div id="row">
<button onclick="pickDevice('TV')">TV</button>
<button onclick="pickDevice('Fan')">Fan</button>
<button onclick="pickDevice('Bulb')">Bulb</button>
<button class="secondary" onclick="pickRenewable('Solar')">Solar</button>
<button class="secondary" onclick="pickRenewable('Wind')">Wind</button>
</div>
<div id="row">
<span class="pill">Hours/day: <span id="hoursLabel">4</span></span>
<input id="hours" type="range" min="1" max="24" value="4" oninput="updateHours(this.value)" />
<span class="pill">Energy: <span id="energyLabel">--</span> Wh/day</span>
<span class="pill" id="recommended">Select device & renewable</span>
</div>
<div id="info">Select a device and renewable energy source to begin.</div>
</div>

<button id="demoBtn" onclick="goDemo()">ðŸŽ¬ Watch Demo</button>

<script>

/* ---- YOUR ORIGINAL LOGIC BELOW (UNCHANGED) ---- */

const MODEL_CONFIG = {
TV:{ pos:'-0.25 0.20 0', scale:'0.3 0.15 0.02', rot:'0 0 0' },
Fan:{ pos:'-0.25 0.20 0', scale:'0.1 0.1 0.1', rot:'-90 0 0' },
Bulb:{ pos:'-0.25 0.20 0', scale:'5 5 5', rot:'0 0 0' },
Solar:{ pos:'0.25 0.20 0', scale:'0.3 0.3 0.3', rot:'-90 0 0' },
Wind:{ pos:'0.25 0.20 0', scale:'0.3 0.3 0.3', rot:'-90 0 0' }
};

const DEVICE_WATTS = { TV:120, Fan:50, Bulb:10 };
const DEVICE_MODEL = { Fan:'#m-fan', Bulb:'#m-bulb' };
const RENEW_MODEL = { Solar:'#m-solar', Wind:'#m-wind' };

let selectedDevice=null;
let selectedRenew=null;
let hoursPerDay=4;

const deviceEl=()=>document.querySelector('#device');
const renewPivotEl=()=>document.querySelector('#renewablePivot');
const renewEl=()=>document.querySelector('#renewable');
const demoBtn=document.querySelector('#demoBtn');
const status=document.querySelector('#status');

function whPerDay(w,h){return Math.round(w*h);}

function updateUI(){
document.querySelector('#hoursLabel').textContent=hoursPerDay;
if(selectedDevice&&selectedRenew){
const watts=DEVICE_WATTS[selectedDevice];
const wh=whPerDay(watts,hoursPerDay);
document.querySelector('#energyLabel').textContent=wh;
demoBtn.classList.add('visible');
}else{
document.querySelector('#energyLabel').textContent='--';
demoBtn.classList.remove('visible');
}
}

function clearEntity(el){
el.removeAttribute('gltf-model');
el.removeAttribute('geometry');
el.removeAttribute('material');
}

function applyTransform(el,cfg){
el.setAttribute('position',cfg.pos);
el.setAttribute('scale',cfg.scale);
el.setAttribute('rotation',cfg.rot);
}

function pickDevice(name){
selectedDevice=name;
const d=deviceEl();
clearEntity(d);
applyTransform(d,MODEL_CONFIG[name]);
d.setAttribute('visible',true);
if(name==='TV'){
d.setAttribute('geometry','primitive: box');
d.setAttribute('material','color: #1a1a1a');
}else{
d.setAttribute('gltf-model',DEVICE_MODEL[name]);
}
updateUI();
}

function pickRenewable(type){
selectedRenew=type;
const pivot=renewPivotEl();
const child=renewEl();
pivot.setAttribute('visible',true);
applyTransform(pivot,MODEL_CONFIG[type]);
child.setAttribute('position','0 0 0');
child.setAttribute('scale','1 1 1');
child.setAttribute('gltf-model',RENEW_MODEL[type]);
updateUI();
}

function updateHours(v){hoursPerDay=Number(v);updateUI();}

function goDemo(){
if(!selectedDevice||!selectedRenew)return;
const d=selectedDevice.toLowerCase();
const r=(selectedRenew.toLowerCase()==='wind')?'turbine':'solar';
location.href=`demo.html?device=${d}&renew=${r}`;
}

/* ---- NEW MARKER DETECTION ---- */

document.querySelector('#marker-tv').addEventListener('markerFound',()=>{
status.textContent='TV Marker detected âœ…';
selectedDevice='TV';
pickDevice('TV');
});

document.querySelector('#marker-fan').addEventListener('markerFound',()=>{
status.textContent='Fan Marker detected âœ…';
selectedDevice='Fan';
pickDevice('Fan');
});

document.querySelector('#marker-bulb').addEventListener('markerFound',()=>{
status.textContent='Bulb Marker detected âœ…';
selectedDevice='Bulb';
pickDevice('Bulb');
});

updateUI();
</script>

</body>
</html>
